<div class="min-h-screen flex flex-col bg-slate-50">
  <!-- Hero -->
  <section class="relative overflow-hidden bg-[#CFB4FA] text-white">
    <div aria-hidden="true" class="pointer-events-none absolute inset-0">
      <!-- background decorations omitted for brevity -->
    </div>

    <div class="mx-auto max-w-7xl px-4 py-20 sm:px-6 lg:px-8">
      <div class="mx-auto max-w-2xl text-center relative">
        <img height="500px" src="/BreatheOverMatter.png" alt="">
        <h1 class="text-white/90">
          Breathe into the moment.
        </h1>

        <!-- Category chips -->
        <div class="mt-6 flex flex-wrap items-center justify-center gap-2">
          <button
            type="button"
            class="rounded-full px-3.5 py-1.5 text-sm font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white"
            [ngClass]="isAllActive() ? 'bg-white text-indigo-700 shadow-md' : 'bg-white/25 text-white hover:bg-white/35 ring-1 ring-white/35'"
            (click)="clearFilter()"
            [attr.aria-pressed]="isAllActive()"
          >
            All
          </button>

          <button
            *ngFor="let c of categoryChips"
            type="button"
            class="rounded-full px-3.5 py-1.5 text-sm font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white"
            [ngClass]="isActive(c.label) ? c.activeClass : c.idleClass"
            (click)="toggleFilter(c.label)"
            [attr.aria-pressed]="isActive(c.label)"
          >
            {{ c.label }}
          </button>
        </div>

        <!-- Search input + results -->
        <div class="mt-8 flex flex-col items-center justify-center">
          <input
            type="search"
            placeholder="Search techniques…"
            class="w-full max-w-md rounded-xl border-0 bg-white/10 px-4 py-2 text-sm text-white placeholder-white/70 outline-none ring-1 ring-white/30 focus:ring-2 focus:ring-white"
            [ngModel]="q()"
            (ngModelChange)="q.set($event)"
          />

          <!-- Results count -->
          <ng-container *ngIf="(techniques$ | async) as list">
            <div class="mt-2 text-sm text-white/80">
              {{
                filtered()(list).length === 0
                  ? 'No results found'
                  : filtered()(list).length + ' result' + (filtered()(list).length === 1 ? '' : 's') + ' found'
              }}
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </section>

  <!-- Main content -->
  <main class="relative flex-1 bg-slate-50">
    <!-- B) soft top gradient that blends with hero -->
    <div
      aria-hidden="true"
      class="pointer-events-none absolute inset-x-0 top-0 h-56
             bg-gradient-to-b from-indigo-100/60 via-indigo-50/30 to-transparent">
    </div>

    <!-- Before you start (dismissible) -->
    <section class="-mt-8" *ngIf="showSafety()">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="mx-auto max-w-3xl rounded-2xl border border-white/60 bg-white/95 p-6 shadow-xl backdrop-blur relative">
          <!-- ✕ close button -->
          <button
            type="button"
            class="absolute right-2 top-2 inline-flex h-8 w-8 items-center justify-center rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500/60"
            (click)="closeSafety()"
            aria-label="Dismiss"
          >
            <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M6 6l12 12M18 6l-12 12" />
            </svg>
          </button>

          <h3 class="text-lg font-semibold">Before you start</h3>
          <ul class="mt-3 list-disc space-y-1 pl-5 text-sm text-gray-700">
            <li>These breathing exercises support relaxation and focus and are not intended as medical advice or medical treatment.</li>
            <li>Stop if you feel dizzy or uncomfortable. </li>
            <li>Consult your doctor if you have health concerns.</li>
            <li>If you feel dizzy or unwell, slow down or stop.</li>
            <li>If you have thoughts of self-harm or suicide, please contact your local emergency department or 9-8-8 for immediate help.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Techniques -->
    <app-section id="techniques" class="min-h-[200px]">
      <h2 class="text-xl font-semibold">Techniques</h2>

      <div class="mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
        <ng-container *ngIf="(techniques$ | async) as list">
          <ng-container *ngIf="filtered()(list).length > 0; else noResults">
            <article
              *ngFor="let t of filtered()(list)"
              class="group relative grid h-full grid-rows-[auto_auto_auto_1fr_auto] rounded-2xl border border-gray-200 bg-white p-4 shadow-sm transition hover:-translate-y-0.5 hover:shadow-md focus-within:shadow-md"
            >
              <a
                [routerLink]="['/technique', t.id]"
                class="absolute inset-0 rounded-2xl focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500/60"
                [attr.aria-label]="'Open ' + t.name + ' details'"
              ></a>

              <!-- row 1: title -->
              <h3 class="relative z-[1] mt-2 flex items-center gap-2 text-lg font-semibold text-gray-900">
                {{ t.name }}
              </h3>

              <!-- row 2: subtitle -->
              <p class="relative z-[1] mt-1 text-xs text-gray-500" *ngIf="t.aliases?.length">
                aka {{ t.aliases.join(', ') }}
              </p>

              <!-- row 3: chips (reserve space) -->
              <div
                class="relative z-[1] mt-1 flex flex-wrap gap-1 py-1
                      min-h-[2.75rem] sm:min-h-[3rem]"
              >
                <app-breath-chip *ngFor="let c of t.categories | slice:0:4" [label]="c"></app-breath-chip>
              </div>

              <!-- row 4: description -->
              <p class="relative z-[1] mt-3 line-clamp-3 text-sm leading-6 text-gray-600">
                {{ t.short_desc || 'Open to learn' }}
              </p>

              <!-- row 5: CTA -->
              <div class="relative z-[1] mt-4 self-end">
                <a
                  [routerLink]="['/technique', t.id]"
                  [queryParams]="{ start: true }"
                  class="inline-flex h-9 min-w-[7.25rem] items-center justify-center gap-2 rounded-lg border border-indigo-600 bg-indigo-600 px-3 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-50 hover:text-indigo-700 hover:border-indigo-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500/60"
                >
                  <span>Begin</span>
                </a>
              </div>
            </article>

          </ng-container>

          <ng-template #noResults>
            <p class="text-center text-gray-500 col-span-full">No techniques found</p>
          </ng-template>
        </ng-container>
      </div>
    </app-section>
  </main>

  <!-- Footer pinned to bottom -->
  <footer class="border-t bg-gray-50 py-10 text-sm text-gray-600">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col items-center justify-between gap-4 sm:flex-row">
        <div>© {{ year }} Vlasic Technologies</div>
        <div class="flex items-center gap-6">
          <a href="mailto:info@vasic.tech" class="hover:text-gray-800">Contact</a>
          <a href="#" class="hover:text-gray-800">Privacy</a>
          <a href="#" class="hover:text-gray-800">Terms</a>
        </div>
      </div>
    </div>
  </footer>
</div>
